# External Method for importing FSD People from a CSV file
#
# Written by: Paul Rentschler / Eric Steele
# Creation Date: 13 October 2009
#

def ImportFSDPeople(self):
  # define the file that will be imported
  file = self['fsd-import.csv']
  
  # define who will be the personal assistant for these people
  asstUID = self.people.jeb2.UID()
  
  # set the location of the FSD
  directory = self.people
  
  # loop through all the lines in the CSV file except the first (it has headers)
  for line in file.data.split('\r')[1:]:
    # define all the values in the line
    id, firstname, middlename, lastname, suffix, classification, email, campus, phone, web = line.split(',')
    
    # see if the user exists in FSD
    if not id in directory.objectIds():
      # the user does not exist
      
      # get the classification UID for this user's classification
      classificationUID = self.portal_catalog(Title=classification)[0].UID
      
      # create the FSD person
      directory.invokeFactory('FSDPerson', id=id, firstName=firstname, middleName=middlename, lastName=lastname, suffix=suffix, classifications=[classificationUID], email=email, campus=[campus], officePhone=phone, websites=web)
      directory[id].at_post_create_script()
      
      
    # get the personal assistants for this person
    currentAssistants = directory[id].getAssistants()
    
    # if the personal assistant is not assigned to this person, assign them
    if not asstUID in currentAssistants:
      currentAssistants.extend([asstUID])
      directory[id].setAssistants(currentAssistants)
